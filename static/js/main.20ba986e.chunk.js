(window.webpackJsonpchat=window.webpackJsonpchat||[]).push([[0],{10:function(e,t,a){e.exports=a(17)},15:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),s=a(4),o=(a(15),a(7)),i=a(1),l=a(2),r=a(8),m=a(5),u=a(9),g=function(e){return c.a.createElement(c.a.Fragment,null,c.a.createElement("button",{className:"log-out",onClick:e.onClick},"Log out"))},d=function(e){return c.a.createElement(c.a.Fragment,null,c.a.createElement("header",{className:"header header_open"},c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"header__wrapper"},c.a.createElement("div",{className:"header__column"},c.a.createElement("h1",{className:"header__title"},"Chat")),c.a.createElement("div",{className:"header__column"},c.a.createElement("span",{className:"header__description"},"You are logged in as:"),c.a.createElement("span",{className:"header__nickname"},e.nickName)),c.a.createElement("div",{className:"header__column"},c.a.createElement(g,{onClick:e.onClick}))))))},h=a(6),p=a.n(h),f=function(e){var t=new Date(e.time),a=t.getHours()<10?"0".concat(t.getHours()):t.getHours(),n=t.getMinutes()<10?"0".concat(t.getMinutes()):t.getMinutes(),s="".concat(a,":").concat(n);return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"message"},c.a.createElement("div",{className:"message__row"},c.a.createElement("span",{className:"message__nick-name"},e.from)),c.a.createElement("div",{className:"message__row"},c.a.createElement("p",{className:"message__text-message"},e.message),c.a.createElement("span",{className:"message__date"},s))))},v=function(e){return Object(n.useLayoutEffect)(function(){!function(e){var t=document.querySelector(e);t.scrollTop=t.scrollHeight}(".chat__message-container")}),c.a.createElement(c.a.Fragment,null,c.a.createElement("main",{className:"main"},c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"chat"},c.a.createElement("div",{className:"chat__message-container"},e.listMessage.sort(function(e,t){return e.time-t.time}).map(function(e){return c.a.createElement(f,Object.assign({},e,{key:p()()}))})),c.a.createElement("form",{className:"chat__form",action:""},c.a.createElement("textarea",{className:"chat__input-fields input",type:"text",placeholder:"Enter message",required:!0}),c.a.createElement("button",{className:"chat__send-button button",onClick:e.onClick},"send"))))))},E=function(e){return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"popup"},c.a.createElement("form",{className:"popup__form",action:""},c.a.createElement("h2",{className:"popup__title"},"Enter your name"),c.a.createElement("input",{className:"popup__name input",type:"text",placeholder:"Your name",required:!0}),c.a.createElement("button",{className:"popup__button button",onClick:e.onClick},"Ok"))))},_=new(function(){function e(t){Object(i.a)(this,e),this.url=t,this.socket=new WebSocket(this.url),this.idReconnecting=null,window.socket=this.socket}return Object(l.a)(e,[{key:"initEvents",value:function(e,t){var a=this,n=e.onerror,c=e.onopen,s=e.onclose,o=e.onmessage;this.events=e,this.context=t,this.socket.onerror=function(e){n.call(t,e)},this.socket.onopen=function(e){clearInterval(a.idReconnecting),c.call(t,e)},this.socket.onclose=function(e){s.call(t,e)},this.socket.onmessage=function(e){o.call(t,e)}}},{key:"sendData",value:function(e){this.socket.send(e)}},{key:"reconnecting",value:function(e){var t=this;clearInterval(this.idReconnecting),this.idReconnecting=setInterval(function(){t.socket=new WebSocket(t.url),t.initEvents(t.events,t.context)},e)}}]),e}())("ws://st-chat.shas.tel"),k=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return(a=Object(r.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(c)))).state={isActivePage:!0,isLogIn:window.localStorage.nickName,listMessage:[]},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"setNickNameEvent",value:function(){var e=document.querySelector(".popup__name").value;window.localStorage.setItem("nickName",e),this.setState({isLogIn:e})}},{key:"logOut",value:function(){window.localStorage.clear(),this.setState({isLogIn:null})}},{key:"sendMessage",value:function(e){e.preventDefault();var t=document.querySelector(".chat__input-fields").value;_.sendData(JSON.stringify({from:this.state.isLogIn,message:t}))}},{key:"componentDidMount",value:function(){var e=this;_.initEvents({onerror:function(e){console.log(e.message)},onopen:function(){console.log("\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e.")},onclose:function(){_.reconnecting(1e3)},onmessage:function(t){var a=JSON.parse(JSON.stringify(e.state.listMessage));a.push.apply(a,Object(o.a)(JSON.parse(t.data))),e.setState({listMessage:a})}})}},{key:"render",value:function(){var e=this;window.addEventListener("blur",function(){e.setState({isActivePage:!1})}),window.addEventListener("focus",function(){e.setState({isActivePage:!0})});var t=this.state.isLogIn,a=c.a.createElement(c.a.Fragment,null,c.a.createElement(d,{nickName:t,onClick:function(){e.logOut()}}),c.a.createElement(v,{onClick:function(t){e.sendMessage(t)},listMessage:this.state.listMessage}));return t||(a=c.a.createElement(E,{onClick:function(){e.setNickNameEvent()}})),a}}]),t}(n.Component);Object(s.render)(c.a.createElement(k,null),document.getElementById("root"))}},[[10,1,2]]]);
//# sourceMappingURL=main.20ba986e.chunk.js.map