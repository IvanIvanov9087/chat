{"version":3,"sources":["components/log-out.component.js","components/header.component.js","components/message.component.js","components/chat-container.component.js","helpers/chat-container.helper.js","components/log-in-popup.component.js","helpers/app.helper.js","components/app.component.js","index.js"],"names":["props","className","onClick","nickName","date","Date","time","hours","getHours","minuts","getMinutes","from","message","useLayoutEffect","selector","element","document","querySelector","scrollTop","scrollHeight","scrollToBottom","listMessage","sort","a","b","map","item","key","uniqid","action","type","placeholder","required","webSocketHelper","url","this","socket","WebSocket","idReconnecting","window","events","context","onerror","onopen","onclose","onmessage","event","call","clearInterval","data","send","interval","setInterval","initEvents","App","state","isActivePage","isLogIn","localStorage","value","setItem","setState","clear","preventDefault","messageText","sendData","JSON","stringify","error","console","log","reconnecting","parse","push","addEventListener","renderItem","logOut","sendMessage","setNickNameEvent","Component","render","getElementById"],"mappings":"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","file":"static/js/main.20ba986e.chunk.js","sourcesContent":["import React from 'react';\n\n\nexport default (props) => <>\n    <button className='log-out' onClick={ props.onClick }>Log out</button>\n</>","import React from 'react';\n\nimport LogOut from './log-out.component';\n\nexport default (props) => <>\n    <header className='header header_open'>\n        <div className=\"container\">\n            <div className=\"header__wrapper\">\n                <div className='header__column'>\n                    <h1 className='header__title'>Chat</h1>\n                </div>\n\n                <div className='header__column'>\n                    <span className='header__description'>You are logged in as:</span>\n                    <span className='header__nickname'>{props.nickName}</span>\n                </div>\n                <div className='header__column'>    \n                    <LogOut onClick={ props.onClick } />\n                </div>\n            </div>\n        </div>\n    </header>\n</>","import React from 'react';\n\n\nexport default (props) => {\n    const date = new Date(props.time);\n    const hours = date.getHours() < 10 ? `0${date.getHours()}` : date.getHours();\n    const minuts = date.getMinutes() < 10 ? `0${date.getMinutes()}` : date.getMinutes();\n\n    let time = `${hours}:${minuts}`;\n\n    return <> \n        <div className='message'>\n            <div className='message__row'>\n                <span className='message__nick-name'>{ props.from }</span>\n            </div>\n            <div className='message__row'>\n                <p className='message__text-message'>{ props.message }</p>\n                <span className='message__date'>{ time }</span>\n            </div>\n        </div>\n    </>\n}","import React, { useLayoutEffect } from 'react';\nimport uniqid from 'uniqid';\n\nimport Message from './message.component';\nimport scrollToBottom from '../helpers/chat-container.helper';\n\n\nexport default (props) => {\n    useLayoutEffect(() => {\n        scrollToBottom('.chat__message-container');\n    });\n\n    return <>\n        <main className='main'>\n            <div className='container'>\n                <div className='chat'>\n                    <div className='chat__message-container'>\n                        {\n                            props.listMessage.sort((a, b) => {\n                                return a.time - b.time;\n                            }).map((item) => {\n                                return <Message {...item} key={uniqid()}/>\n                            })\n                        }\n                    </div>\n\n                    <form className='chat__form' action=''>\n                        <textarea className='chat__input-fields input' type='text' placeholder='Enter message' required></textarea>\n\n                        <button className='chat__send-button button' onClick={ props.onClick }>send</button>\n                    </form>\n                </div>\n            </div>\n        </main>\n    </>\n}","export default (selector) => {\n    const element = document.querySelector(selector);\n\n    element.scrollTop = element.scrollHeight;\n}   ","import React from 'react';\n\n\nexport default (props) => <>\n    <div className='popup'>\n        <form className='popup__form' action=''>\n            <h2 className='popup__title'>Enter your name</h2>\n\n            <input className='popup__name input' type='text' placeholder='Your name' required/>\n\n            <button className='popup__button button' onClick={ props.onClick }>Ok</button>\n        </form>\n    </div>\n</>","class WebSocketHelper {\n    constructor(url) {\n        this.url = url;\n        this.socket = new WebSocket(this.url);\n        this.idReconnecting = null;\n\n        window.socket =  this.socket\n    }\n\n    initEvents(events, context) {\n        const { onerror, onopen, onclose, onmessage } = events;\n        this.events = events;\n        this.context = context;\n\n        this.socket.onerror = (event) => {\n            onerror.call(context, event);\n        }\n        this.socket.onopen = (event) => {\n            clearInterval(this.idReconnecting);\n            onopen.call(context, event);\n        }\n        this.socket.onclose = (event) => {\n            onclose.call(context, event);\n        };\n        this.socket.onmessage = (event) => {\n            onmessage.call(context, event);\n        };;\n    }\n\n    sendData(data) {\n        this.socket.send(data);\n    }\n\n    reconnecting(interval) {\n        clearInterval(this.idReconnecting);\n\n        this.idReconnecting = setInterval(() => {\n            this.socket = new WebSocket(this.url);\n\n            this.initEvents(this.events, this.context);\n        }, interval);\n    }\n}\n\nconst webSocketHelper = new WebSocketHelper('ws://st-chat.shas.tel')\n\nexport  {\n    webSocketHelper\n};","import React, { Component} from 'react';\n\nimport Header from  './header.component';\nimport ChatContainer from './chat-container.component';\nimport LogInPopup from './log-in-popup.component';\nimport { webSocketHelper } from '../helpers/app.helper';\n\n\nclass App extends Component {\n    state = { \n        isActivePage: true,\n        isLogIn: window.localStorage.nickName,\n        listMessage: [],\n    }\n\n    setNickNameEvent() {\n        const nickName = document.querySelector('.popup__name').value;\n        window.localStorage.setItem('nickName', nickName);\n\n        this.setState({\n            isLogIn: nickName,\n        })\n    }\n\n    logOut() {\n        window.localStorage.clear();\n\n        this.setState({\n            isLogIn: null,\n        })\n    }\n\n    sendMessage(event) {\n        event.preventDefault();\n\n        const messageText = document.querySelector('.chat__input-fields').value;\n\n        webSocketHelper.sendData(JSON.stringify({\n            from: this.state.isLogIn,\n            message: messageText,\n        }));\n    }\n\n    componentDidMount() {\n        webSocketHelper.initEvents({\n            onerror: (error) => {\n                console.log(error.message);\n            },\n            onopen: () => {\n                console.log('Соединение установлено.');\n            },\n            onclose: () => {\n                webSocketHelper.reconnecting(1000);\n            },\n            onmessage: (event) => {\n                const listMessage = JSON.parse(\n                    JSON.stringify(this.state.listMessage)\n                );\n                listMessage.push(...JSON.parse(event.data));\n\n                this.setState({\n                    listMessage\n                });\n            },\n        });\n    }\n\n    render() {\n        window.addEventListener('blur', () => {\n            this.setState({\n                isActivePage: false,\n            })\n        })\n        \n        window.addEventListener('focus', () => {\n            this.setState({\n                isActivePage: true,\n            })\n        })\n\n\n        const nickName = this.state.isLogIn;\n\n        let renderItem = <>\n            <Header \n                nickName={ nickName } \n                onClick={() => { this.logOut() }}\n            />\n            <ChatContainer \n                onClick={(event) => { this.sendMessage(event) }} \n                listMessage={ this.state.listMessage }\n            />\n        </>;\n\n        if (!nickName) {\n            renderItem = <LogInPopup onClick={() => { this.setNickNameEvent() }}/>;\n        }\n\n        return renderItem\n    }\n}\n\nexport default App;","import React from 'react';\nimport { render } from 'react-dom';\nimport './styles/index.scss';\nimport App from './components/app.component';\n\nrender(<App />, document.getElementById('root'));\n"],"sourceRoot":""}